class Random{static generate(t,e){return Math.floor(Math.random()*(e-t+1))+t}}class CrazyText{constructor(t,e){this.container=document.getElementById(t),this.text=e,this.animationsList=this.getAnimationsList(),this.prevAnimation=0,this.totalAnimations=5,this.animationDuration=1,this.init()}init(){for(var t of this.text){t=this.makeAnimatedLetter(t);this.container.appendChild(t)}}makeAnimatedLetter(t){const e=document.createElement("span");return 0!==(e.textContent=t).trim().length&&(this.setAnimation(e),setInterval(()=>{this.setAnimation(e)},1e3)),e}setAnimation(t){let e=Random.generate(1,this.totalAnimations);this.prevAnimation===e&&(e=e<this.totalAnimations?e+1:e-1),this.prevAnimation=e;var a=this.animationsList[Random.generate(0,this.animationsList.length)-1];t.classList.add("animateCrazyText"),t.setAttribute("style",`animation-name: crazyTextAnimation${e}; animation-duration: ${this.animationDuration}s; animation-timing-function: ${a};`)}getAnimationsList(){return["linear","ease","ease-in","ease-out","ease-in-out"]}}class Toast{static TOAST_SUCCESS="toast-success";static TOAST_ERROR="toast-error";constructor(t,e={}){this.container=document.querySelector(".toast-container")??this.createContainer(),this.text=t,this.type=e.type??null,this.autoclose=e.autoclose??!0,this.duration=1e3*(e.duration??8),this.autocloseTimeout=void 0,this.create()}createContainer(){var t=document.createElement("div");return t.classList.add("toast-container"),document.querySelector("body").appendChild(t),t}create(){const t=document.createElement("div");var e=document.createElement("div"),a=document.createElement("button");e.classList.add("toast-body"),e.innerHTML=this.text,a.classList.add("toast-btn-close"),a.innerHTML="&#x2716;",a.addEventListener("click",()=>this.removeToast(t)),t.classList.add("toast","bounceInLeft","animated"),t.appendChild(e),t.appendChild(a),this.type&&t.classList.add(this.type),this.autoclose&&(this.autocloseTimeout=setTimeout(()=>this.removeToast(t),this.duration)),this.container.appendChild(t)}removeToast(t){this.autocloseTimeout&&clearTimeout(this.autocloseTimeout),t.classList.remove("bounceInLeft"),t.classList.add("bounceOutLeft"),setTimeout(()=>t.remove(),500)}}class Paginator{static CLASSESS={SHOW_PAGE_SELECT:"showing-page-select",DISPLAYED_PAGE_SELECT:"displayed-page-select"};static DIRECTIONS={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right"};static ANIMATIONS_TIME={PAGE_SELECT:750,PAGE_SELECT_WITHOUT_ANIMATION:250};static NBR_BTNS_TO_SHOW_VALUE=5;static TIMEOUT_CALL_ACTION_VALUE=400;constructor(t){this.action=t.action,this.timeoutCallAction=void 0,this.timeoutCallActionActive=!1,this.flags={animatingPageButtons:!1},this.cache={currentPage:{page:t.currentPage,rangeButtons:null}},this.totalPages=t.totalPages,this.currentPage=t.currentPage,this.btnHeight=2.5,this.btnWidth=this.btnHeight,this.nbrBtnsToShow=this.totalPages<Paginator.NBR_BTNS_TO_SHOW_VALUE?this.totalPages:Paginator.NBR_BTNS_TO_SHOW_VALUE,this.pageSelectHeight=this.btnHeight*(this.nbrBtnsToShow+2),this.pageSelectTop=-1*this.pageSelectHeight,this.pagesContainerHeight=this.btnHeight*this.nbrBtnsToShow,this.initDomElements(t.paginatorId)}async initDomElements(t){this.paginator=document.getElementById(t),this.paginator.classList.add("pagination"),await this.createElements(),await this.appendElements()}createElements(){this.btnPrevPg=this.makeControl(["prev-page","disabled"],"",{event:"click",func:()=>this.changePage(Paginator.DIRECTIONS.LEFT)}),this.btnCurrentPg=this.makeControl(["current-page"],this.currentPage,{event:"click",func:()=>{this.cachingCurrentPage(this.currentPage),this.centerPage(this.currentPage),this.togglePageSelect()}});var t=["next-page"],t=(this.totalPages<=Paginator.NBR_BTNS_TO_SHOW_VALUE&&t.push("disabled"),this.btnNextPg=this.makeControl(t,"",{event:"click",func:()=>this.changePage(Paginator.DIRECTIONS.RIGHT)}),this.pageSelect=this.makeDiv(["page-select"],[{name:"style",value:"height: 0rem; top: 0rem"}]),this.btnArrowUp=this.makeControl(["arrow-up","disabled"],"",{event:"click",func:()=>this.movePageButtons(Paginator.DIRECTIONS.UP)}),this.pagesContainer=this.makeDiv(["pages-container"],[{name:"style",value:`height: ${this.pagesContainerHeight}rem`}]),this.pagesGroup=this.makeDiv(["pages-group"]),this.pageButtons=this.makePageButtons(),["arrow-down"]);this.totalPages<=Paginator.NBR_BTNS_TO_SHOW_VALUE&&t.push("disabled"),this.btnArrowDown=this.makeControl(t,"",{event:"click",func:()=>this.movePageButtons(Paginator.DIRECTIONS.DOWN)})}appendElements(){this.pageButtons.forEach(t=>this.pagesGroup.appendChild(t)),this.pagesContainer.appendChild(this.pagesGroup),this.pageSelect.appendChild(this.btnArrowUp),this.pageSelect.appendChild(this.pagesContainer),this.pageSelect.appendChild(this.btnArrowDown),this.paginator.appendChild(this.btnPrevPg),this.paginator.appendChild(this.btnCurrentPg),this.paginator.appendChild(this.btnNextPg),this.paginator.appendChild(this.pageSelect)}togglePageSelect(){if(this.flags.animatingPageButtons)return!1;this.flags.animatingPageButtons=!0;const{SHOW_PAGE_SELECT:t,DISPLAYED_PAGE_SELECT:e}=Paginator.CLASSESS,a=this.paginator.classList.contains(e);a?this.pageSelect.setAttribute("style","height: 0rem; top: 0rem"):(this.paginator.classList.add(t),this.pageSelect.setAttribute("style",`height: ${this.pageSelectHeight}rem; top: ${this.pageSelectTop}rem`)),setTimeout(()=>{this.flags.animatingPageButtons=!1,this.paginator.classList.toggle(e),a&&this.paginator.classList.toggle(t)},Paginator.ANIMATIONS_TIME.PAGE_SELECT)}makeElement(t,e,a="",i=[],s=null){const n=document.createElement(t);return n.classList.add(...e),n.innerHTML=a,i.forEach(t=>n.setAttribute(t.name,t.value)),null!==s&&n.addEventListener(s.event,s.func),n}makeDiv(t,e=[]){return this.makeElement("div",t,"",e)}makeControl(t,e="",a=null){return this.makeElement("a",["control",...t],e,[{name:"href",value:"javascript:void(0)"}],a)}makePageButtons(){var e=[];for(let t=1;t<=this.totalPages;++t){var a=["page"];t==this.currentPage&&a.push("active"),e.push(this.makeControl(a,t,{event:"click",func:()=>this.pageSelected(t)}))}return e}changePage(t){var t=t===Paginator.DIRECTIONS.LEFT,e=t?this.currentPage-1:this.currentPage+1;if(t&&e<1||!t&&e>this.totalPages)return!1;this.cachingCurrentPage(e),this.btnCurrentPg.textContent=e,this.makePageButtonActive(e,this.currentPage),this.callAction(e),this.centerPage(e),this.disableEnableBtnsSelectPage(e),this.currentPage=e}pageSelected(t){var e=this.pagesGroup.style.transform,t=(this.makePageButtonActive(t,this.currentPage),this.callAction(t),this.centerPage(t),this.disableEnableBtnsSelectPage(t),this.pagesGroup.style.transform),e=e!=t?Paginator.ANIMATIONS_TIME.PAGE_SELECT:Paginator.ANIMATIONS_TIME.PAGE_SELECT_WITHOUT_ANIMATION;setTimeout(()=>{this.togglePageSelect()},e)}centerPage(t){var e=this.calcPageButtonsRange(t),e=this.btnHeight*-(e.start-1);this.pagesGroup.setAttribute("style",`transform: translateY(${e}rem)`),this.currentPage=t,this.btnCurrentPg.textContent=t}disableEnableBtnsSelectPage(t){var{start:e,end:a}=this.calcPageButtonsRange(t);this.btnPrevPg.classList.remove("disabled"),this.btnNextPg.classList.remove("disabled"),1==t&&this.btnPrevPg.classList.add("disabled"),t==this.totalPages&&this.btnNextPg.classList.add("disabled"),this.disableEnableBtnsNavigationPage(e,a),this.disableEnableBtnsNavigationPage(e,a)}disableEnableBtnsNavigationPage(t,e){this.btnArrowUp.classList.remove("disabled"),this.btnArrowDown.classList.remove("disabled"),1===t&&this.btnArrowUp.classList.add("disabled"),e===this.totalPages&&this.btnArrowDown.classList.add("disabled")}callAction(t){this.timeoutCallActionActive&&(clearTimeout(this.timeoutCallAction),this.timeoutCallActionActive=!1),this.timeoutCallActionActive=!0,this.timeoutCallAction=setTimeout(()=>{this.timeoutCallActionActive=!1,this.action(t)},Paginator.TIMEOUT_CALL_ACTION_VALUE)}makePageButtonActive(t,e){this.pageButtons[t-1].classList.add("active"),this.pageButtons[e-1].classList.remove("active")}movePageButtons(t){var e,t=t===Paginator.DIRECTIONS.UP;let a=0,i=0,s=(i=null===this.cache.currentPage.rangeButtons?({start:c,end:e}=this.calcPageButtonsRange(this.cache.currentPage.page),a=c,e):({start:c,end:e}=this.cache.currentPage.rangeButtons,a=c,e),t?this.cache.currentPage.page-this.nbrBtnsToShow:this.cache.currentPage.page+this.nbrBtnsToShow),n=t?a-this.nbrBtnsToShow:a+this.nbrBtnsToShow,r=t?i-this.nbrBtnsToShow:i+this.nbrBtnsToShow,o=t?a-this.nbrBtnsToShow:i+1;t&&n<1?(s=this.cache.currentPage.page,o=1,n=1,r=this.nbrBtnsToShow):!t&&r>this.totalPages&&(s=this.cache.currentPage.page,o-=r-this.totalPages,n=o,r=this.totalPages);var c=this.btnHeight*(o-1)*-1;this.cache.currentPage.page=s,this.cache.currentPage.rangeButtons={start:n,end:r},this.disableEnableBtnsNavigationPage(n,r),this.pagesGroup.setAttribute("style",`transform: translateY(${c}rem)`)}calcPageButtonsRange(t){var e=this.nbrBtnsToShow%2,a=Math.floor(this.nbrBtnsToShow/2);let i=0!=e?t-a:t-a+1,s=t+a;return(s=0<i?s:s+-i+1)>this.totalPages&&(i-=s-this.totalPages,s=this.totalPages),{start:0<i?i:1,end:s}}cachingCurrentPage(t){this.cache.currentPage={page:t,rangeButtons:null}}}const BASE_URL="https://rickandmortyapi.com/api/",charactersContainer=document.getElementById("characters-container"),characterTemplate=document.getElementById("character-template"),txtSearch=document.getElementById("txt-search"),btnSearch=document.getElementById("btn-search"),divLoadingCharacters=document.getElementById("loading-characters"),characterDetail=document.getElementById("character-detail"),cdBtnClose=characterDetail.querySelector(".cd-btn-close"),cdName=characterDetail.querySelector(".cd-name"),cdStatus=characterDetail.querySelector(".cd-status"),cdImg=characterDetail.querySelector(".cd-img"),cdProperties=characterDetail.querySelector(".cd-properties");let objCdNameCrazyText=void 0;const characters={data:[]},handler={get(t,e){return"object"==typeof t[e]&&null!==t[e]?new Proxy(t[e],handler):t[e]},set:function(t,e,a,i){return t[e]=a,"length"!==e&&(charactersContainer.textContent="",characters.data.forEach(t=>{var e=characterTemplate.content.cloneNode(!0),a=e.querySelector(".character"),i=e.querySelector(".ch-img"),s=e.querySelector(".ch-name"),n=e.querySelector(".ch-status");i.setAttribute("style",`background-image: url(${t.image})`),s.textContent=t.name,n.classList.add(t.status.toLowerCase()),n.textContent=t.status,charactersContainer.appendChild(e),a.addEventListener("click",()=>showCharacterDetail(t))})),!0}},charactersProxy=new Proxy(characters,handler);let paginator=null;async function searchCharactersByName(e,t=null){divLoadingCharacters.classList.add("show");try{var a=null===t?BASE_URL+"character/?name="+e:BASE_URL+`character/?page=${t}&name=`+e,i=await(await fetch(a)).json();if("error"in i)return new Toast("Sin resultados en la búsqueda."),!1;var s={totalPages:i.info.pages,currentPage:t??1,paginatorId:"paginator",action(t){searchCharactersByName(e,t)}};charactersProxy.data=i.results,null===t&&(paginator&&(paginator.paginator.textContent="",paginator.paginator.removeAttribute("class")),paginator=new Paginator(s,"paginator")),new Toast(`Mostrando <strong>${i.results.length}</strong> items de
            <strong>${i.info.count}</strong>.`,{type:Toast.TOAST_SUCCESS})}catch(t){new Toast(`Ocurrió un error al realizar la búsqueda de <strong>${e}</strong>.
            Revisa tu conexión a internet.`,{type:Toast.TOAST_ERROR}),console.log(t)}finally{divLoadingCharacters.classList.remove("show")}}function hideCharacterDetail(){objCdNameCrazyText=void 0,characterDetail.classList.add("hidden"),cdName.textContent="",cdProperties.textContent=""}async function showCharacterDetail(t){var e=crypto.randomUUID();characterDetail.classList.remove("hidden"),cdName.setAttribute("id",e),cdStatus.classList.remove("unknown","alive","dead"),cdStatus.classList.add(t.status.toLowerCase()),cdStatus.textContent=t.status,cdImg.setAttribute("style",`background-image: url(${t.image})`),cdProperties.appendChild(createCdPropertyDetail("Species",t.species)),cdProperties.appendChild(createCdPropertyDetail("Type",t.type)),cdProperties.appendChild(createCdPropertyDetail("Gender",t.gender)),cdProperties.appendChild(createCdPropertyDetail("Origin",t.origin.name)),cdProperties.appendChild(createCdPropertyDetail("Location",t.location.name)),0<t.episode.length&&cdProperties.appendChild(await createCdPropertyDetailWithLocations("Episodes",t.episode)),objCdNameCrazyText=new CrazyText(e,t.name)}function createCdPropertyDetail(t,e){var a=document.createElement("div"),i=document.createElement("h3"),s=document.createElement("p");return i.classList.add("cd-property-title"),i.textContent=t,s.classList.add("cd-property-text"),s.textContent=e||"?",a.classList.add("cd-property-detail"),a.appendChild(i),a.appendChild(s),a}async function createCdPropertyDetailWithLocations(t,e){e=e.map(t=>t.split("/").pop()),e=BASE_URL+("episode/"+e.join(","));const a=document.createElement("div");var i=document.createElement("h3");i.classList.add("cd-property-title"),i.textContent=t,a.classList.add("cd-property-detail"),a.appendChild(i);try{var s=await(await fetch(e)).json();if("error"in s)return new Toast("No se pudieron obtener los detalles de los episodios."),!1;Array.isArray(s)?s.forEach(t=>a.appendChild(createPropertyEpisode(t))):a.appendChild(createPropertyEpisode(s))}catch(t){new Toast(`Ocurrió un error al realizar la búsqueda de <strong>episodios</strong> para el personaje.
            Revisa tu conexión a internet.`,{type:Toast.TOAST_ERROR}),console.log(t)}finally{return a}}function createPropertyEpisode(t){var e=document.createElement("div"),a=document.createElement("span"),i=document.createElement("span"),s=document.createElement("span");return a.classList.add("cd-p-episode-number"),a.textContent=t.episode,i.classList.add("cd-p-episode-name"),i.textContent=t.name,s.classList.add("cd-p-episode-date"),s.textContent=t.air_date,e.classList.add("cd-property-episode"),e.appendChild(a),e.appendChild(i),e.appendChild(s),e}txtSearch.addEventListener("keyup",t=>{"Enter"===t.code&&btnSearch.click()}),btnSearch.addEventListener("click",async()=>{var t=txtSearch.value.trim();if(t.length<1)return new Toast("ingresa al menos 1 caracter para el nombre."),!1;searchCharactersByName(t)}),cdBtnClose.addEventListener("click",()=>hideCharacterDetail()),new CrazyText("logo","Rick's Supersystem");